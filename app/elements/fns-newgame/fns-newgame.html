<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">

<polymer-element name="fns-newgame" attributes="cat">
  <template>
    <link rel="stylesheet" href="fns-newgame.css">
    <core-ajax id="ajax" url="https://asl-ranking.firebaseio.com/categories/{{cat}}/games/.json" method="POST" on-core-repsonse="{{testje}}"></core-ajax>
    <div vertical layout center center-justified>
    <div class="titel">
      <p>Start een nieuwe game<br>
      <span><h3>in cat {{cat}}</h3></span></p>
    </div>
    <input id="ploeg1" value="{{ploeg1}}" placeholder="ploeg1" />
    <input id="ploeg2" value="{{ploeg2}}" placeholder="ploeg2" />
    <core-icon-button icon="arrow-forward" on-tap="{{submit}}">Opslaaaan</core-icon-button>
  </div>


  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        // define element prototype here
        submit: function(){
          var that = this;
          this.data = {};
          this.tijd = new Date();
          this.data = {"ploeg1": that.ploeg1, "ploeg2": that.ploeg2, "score1": 0, "score2": 0, time: this.tijd, geolocatie: "xy", "cat": that.cat };
          this.data = JSON.stringify(this.data);
          that.$.ajax.body = this.data;
          that.$.ajax.go();
        },

        ready: function(){
          this.gameentry = true;
          var that = this;
          this.$.ajax.addEventListener("core-response", 
            function(e) {
              this.response = e.detail.response.name;
              console.log('response: ', this.response);
              this.fire('gameStart', { cat: that.cat, game: this.response});
            }
          );
        },

      });

    })();
  </script>
</polymer-element>
