<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../elements/aos-colorpicker/aos-colorpicker.html">


<polymer-element name="fns-newgame" attributes="cat titel">
  <template>
    <link rel="stylesheet" href="fns-newgame.css">
    <core-ajax id="ajax" url="https://asl-ranking.firebaseio.com/categories/{{cat}}/games/.json" method="POST" on-core-repsonse="{{testje}}"></core-ajax>
    <div vertical layout center center-justified>
<!--       <h1>Start een nieuwe game</h1>
      <small>in cat {{cat}}</small> -->
    <h3>Nieuwe <b>{{titel}}</b>game?</h3>
    <small>Geef hier de deelnemers op</small>
    <input id="ploeg1" value="{{ploeg1}}" placeholder="ploeg1" />
    <aos-colorpicker></aos-colorpicker>
    <input id="ploeg2" value="{{ploeg2}}" placeholder="ploeg2" />
    <paper-button on-tap="{{submit}}" stretch>STARTEN</paper-button>
  </div>


  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        // define element prototype here
        submit: function(){
          var that = this;
          this.data = {};
          this.tijd = new Date();
          this.data = {"ploeg1": that.ploeg1, "ploeg2": that.ploeg2, "score1": 0, "score2": 0, time: this.tijd, geolocatie: "xy", "cat": that.cat };
          this.data = JSON.stringify(this.data);
          that.$.ajax.body = this.data;
          that.$.ajax.go();
          //this.fire('submitted');
        },

        ready: function(){
          this.gameentry = true;
          var that = this;
          this.$.ajax.addEventListener("core-response", 
            function(e) {
              this.response = e.detail.response.name;
              this.fire('gameStart', { cat: that.cat, game: this.response});
            }
          );
        },

      });

    })();
  </script>
</polymer-element>
